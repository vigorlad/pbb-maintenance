"""
============================================================
config.py - 설정 및 상수 정의
============================================================
앱 전체에서 공통으로 사용하는 설정값과 상수를 한곳에서 관리합니다.

포함 내용:
  - API 인증키 및 엔드포인트 URL
  - 인천공항 터미널 코드 매핑
  - 한국 표준시(KST) 타임존
  - 국내선 공항 목록
  - 엑셀 컬럼 정의
============================================================
"""

import os
from datetime import timedelta, timezone

# ────────────────────────────────────────────────────────────
# 1) 공공데이터포털 API 설정
# ────────────────────────────────────────────────────────────
# data.go.kr에서 발급받은 서비스 키 (환경변수로 주입)
SERVICE_KEY = os.environ.get("SERVICE_KEY", "")

# 인천공항 운항현황 상세 조회 API 기본 URL
BASE_URL = "https://apis.data.go.kr/B551177/statusOfAllFltDeOdp"

# API 한 번 호출 시 가져올 최대 항목 수
NUM_OF_ROWS = 1000

# ────────────────────────────────────────────────────────────
# 2) 인천공항 터미널 정보
# ────────────────────────────────────────────────────────────
# API 응답의 terminalId → 사람이 읽을 수 있는 터미널 이름
TERMINAL_MAP = {
    "P01": "T1(제1터미널)",
    "P02": "탑승동",
    "P03": "T2(제2터미널)",
}

# 여객 터미널 ID 집합 (화물 터미널 등 제외용)
PASSENGER_TERMINALS = set(TERMINAL_MAP.keys())
# {"P01", "P02", "P03"}

# 엑셀 시트 생성 순서: (터미널ID, 시트이름)
SHEET_ORDER = [
    ("P01", "T1"),
    ("P02", "탑승동"),
    ("P03", "T2"),
]

# ────────────────────────────────────────────────────────────
# 3) 시간대 설정
# ────────────────────────────────────────────────────────────
# 한국 표준시 (UTC+9)
KST = timezone(timedelta(hours=9))

# ────────────────────────────────────────────────────────────
# 4) 국내선/국제선 판별용 공항 목록
# ────────────────────────────────────────────────────────────
# 이 공항이 출발지/도착지이면 국내선(D), 아니면 국제선(I)
DOMESTIC_AIRPORTS = {"김해", "제주"}

# ────────────────────────────────────────────────────────────
# 5) 엑셀 컬럼 정의
# ────────────────────────────────────────────────────────────
# (엑셀 헤더명, 데이터 필드명) 쌍의 리스트
# 필드명이 "_"로 시작하면 API 원본이 아닌 가공 값
EXCEL_COLUMNS = [
    ("운항일자",      "_date"),              # scheduleDatetime에서 날짜만 추출
    ("출도착",        "_flight_type"),        # "A"(도착) 또는 "D"(출발)
    ("편명",          "flightId"),            # 항공편명 (예: KE001)
    ("I/D",           "_intl_domestic"),      # 국제선(I) / 국내선(D)
    ("STA/STD",       "scheduleDatetime"),    # 계획 시각 (Scheduled)
    ("등록기호",      "aircraftRegNo"),       # 항공기 등록번호
    ("ATA/ATD",       "estimatedDatetime"),   # 실제/예상 시각 (Actual/Estimated)
    ("운항여부",      "remark"),              # 운항 상태 (출발, 도착, 지연 등)
    ("주기장",        "fstandPosition"),      # 게이트/주기장 번호
    ("기종",          "aircraftSubtype"),     # 항공기 기종 (예: B737)
    ("출발지공항명",  "_dep_airport"),        # 도착편이면 출발공항, 아니면 "-"
    ("도착지공항명",  "_arr_airport"),        # 출발편이면 도착공항, 아니면 "-"
]